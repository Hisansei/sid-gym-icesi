<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title th:text="'Registrar progreso • ' + ${routine.name}">Registrar progreso</title>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <style>
        body{font-family:system-ui,Arial,sans-serif;max-width:980px;margin:24px auto;padding:0 16px}
        .card{border:1px solid #e5e7eb;border-radius:10px;padding:14px;margin:12px 0}
        .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
        input[type=text], input[type=number], textarea, select{padding:8px;border:1px solid #d1d5db;border-radius:6px}
        button{padding:8px 12px;border:0;border-radius:6px;background:#111827;color:white;cursor:pointer}
        .muted{color:#6b7280}
    </style>
</head>
<body>
<header class="row" style="justify-content:space-between;">
    <div>
        <h1 th:text="'Registrar progreso • ' + ${routine.name}">Registrar progreso</h1>
        <div class="muted" th:text="${today}">hoy</div>
    </div>
    <a class="row" style="text-decoration:none;background:#f3f4f6;padding:8px 12px;border-radius:6px" th:href="@{'/mvc/progress/history'(routineId=${routine.id})}">Ver historial</a>
</header>

<form th:action="@{'/mvc/progress/' + ${routine.id}}" method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

    <section th:each="it : ${routine.exercises}" class="card">
        <h2 th:text="${it.name != null && !#strings.isEmpty(it.name) ? it.name : it.exerciseId}">Ejercicio</h2>
        <div class="row">
            <label>Reps (ej: 10,10,8)
                <input type="text" th:name="${'reps_' + it.id}" placeholder="Separado por comas"/>
            </label>
            <label>Tiempo (segundos)
                <input type="number" min="0" th:name="${'time_' + it.id}" placeholder="0"/>
            </label>
            <label>Nivel de esfuerzo (RPE)
                <select th:name="${'rpe_' + it.id}">
                    <option value="">—</option>
                    <option>Muy fácil</option>
                    <option>Fácil</option>
                    <option>Medio</option>
                    <option>Difícil</option>
                    <option>Muy difícil</option>
                </select>
            </label>
        </div>
        <div class="row" style="margin-top:8px">
            <label style="width:100%">Notas
                <textarea rows="2" style="width:100%" th:name="${'notes_' + it.id}" placeholder="Cómo te fue, sensaciones, etc."></textarea>
            </label>
        </div>
    </section>

    <div class="row" style="justify-content:flex-end">
        <button type="submit">Guardar progreso</button>
    </div>
</form>
</body>
</html>
