<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{components/base :: page(
          title='Plantilla',
          content=~{::content}
      )}">
<section th:fragment="content">
  <link rel="stylesheet" th:href="@{/css/app.css}">
  <header class="site-header">
    <div class="container actions">
      <h1 class="page-title" th:text="${template.name}">Plantilla</h1>
      <nav class="actions">
        <a class="btn" th:href="@{/mvc/routine-templates}">Volver</a>
        <form th:action="@{'/mvc/routine-templates/' + ${template.id} + '/adopt'}" method="post" style="display:inline">
          <button class="btn" type="submit">Crear mi rutina basada en esta plantilla</button>
        </form>
        <a class="btn" sec:authorize="hasAnyRole('TRAINER','ADMIN')" th:href="@{'/mvc/routine-templates/' + ${template.id} + '/edit'}">Editar</a>
        <form sec:authorize="hasAnyRole('TRAINER','ADMIN')" th:action="@{'/mvc/routine-templates/' + ${template.id} + '/delete'}"
              method="post" style="display:inline" onsubmit="return confirm('¿Eliminar esta plantilla?')">
          <button class="btn btn-danger" type="submit">Eliminar</button>
        </form>
      </nav>
    </div>
  </header>

  <main class="container space-y">
    <section class="card">
      <h2>Información</h2>
      <p class="muted"><strong>ID: </strong><span th:text="${template.id}">id</span></p>
      <p><strong>Entrenador: </strong><span th:text="${template.trainerId}">trainer</span></p>
      <p><strong>Nivel: </strong><span th:text="${template.level}">BEGINNER</span></p>
      <p th:if="${template.description}"><strong>Descripción: </strong><span th:text="${template.description}">desc</span></p>
    </section>

    <section class="card">
      <h2>Ejercicios de la plantilla</h2>
      <table class="table">
        <thead><tr><th>#</th><th>Ejercicio</th><th>Series</th><th>Reps</th><th>Descanso</th></tr></thead>
        <tbody>
        <tr th:if="${#lists.isEmpty(items)}">
          <td class="muted" colspan="5">No hay ejercicios.</td>
        </tr>
        <tr th:each="it,idx : ${items}">
          <td th:text="${it.order}">1</td>
          <td th:text="${exerciseMap[it.exerciseId] != null ? exerciseMap[it.exerciseId].name : it.exerciseId}">Nombre</td>
          <td th:text="${it.sets}">0</td>
          <td th:text="${it.reps}">0</td>
          <td th:text="${it.restSeconds}">0</td>
        </tr>
        </tbody>
      </table>
    </section>
  </main>
</section>
</html>
